setwd("C:/Users/Lenovo/OneDrive/Documents/R-for-Data-Science-and-Machine-Learning-with-NBICT-LAB-Batch-8/RDSML-Day-56 ðŸ‘‰ Support Vector Regression in R (Part-4)")
library(e1071)
library(ggplot2)
library(dplyr)
dataset <- read.csv("day.csv")
bike <- dataset %>%
select(cnt, temp, atemp, hum, windspeed, season, yr, mnth,
holiday, weekday, workingday, weathersit)
bike <- bike %>%
mutate(
season = factor(season),
yr = factor(yr),
mnth = factor(mnth),
holiday = factor(holiday),
weekday = factor(weekday),
workingday = factor(workingday),
weathersit = factor(weathersit)
)
str(bike)
set.seed(123)
n <- nrow(bike)
indices <- seq_len(n)
train_idx <- sample(indices, size = 0.7 * n)
train_set <- bike[train_idx, ]
test_set <- bike[-train_idx, ]
num_cols = c("temp","atemp","hum","windspeed")
train_means = sapply(train_set[,num_cols],mean)
train_sd = sapply(train_set[,num_cols],sd)
scale_num = function(df){
df[,num_cols]=sweep(df[,num_cols],2,train_means,"-")
df[,num_cols]=sweep(df[,num_cols],2,train_sd,"/")
df
}
train_scaled = scale_num(train_set)
test_scale = scale_num(test_set)
lm_model = lm(cnt ~., data = train_scaled)
summary(lm_model)
lm_predict = predict(lm_model, newdata = test_scale)
rmse = function(actual, pred) sqrt(mean((actual-pred)^2))
lm_rmse = rmse(test_scale$cnt,lm_predict)
mae = function(actual,pred)mean(abs(actual-pred))
lm_mae = mae(test_scale$cnt,lm_predict)
svr = svm(cnt ~.,data = train_scaled,kernel = "linear")
svr_predict = predict(svr,newdata  = test_scale)
svr_rmse = rmse(test_scale$cnt,svr_predict)
svr_rmse = mae(test_scale$cnt,svr_predict)
svr_rmse
lm_mae
lm_rmse
lm_mae
svr_rmse
svr_rmse
svr = svm(cnt ~.,data = train_scaled,kernel = "rbf")
# Running a non linear SVM model
svr = svm(cnt ~.,data = train_scaled,kernel = "polynomial")
svr_nlin = svm(cnt ~.,data = train_scaled,kernel = "polynomial")
summary(svr_nlin)
nlin_predict = predict(svr_nlin,newdata  = test_scale)
nlin_predict
nlin_mae = mae(test_scale$cnt,nlin_predict)
nlin_mae
# Running a non linear SVM model (TBF kernel)
svr_nlin = svm(cnt ~.,data = train_scaled,kernel = "rbf")
svr_nlin = svm(
cnt ~ .,
data = train_scaled,
kernel = "radial",
cost = 10,
gamma = 0.1,
epsilon = 0.1
)
svr_nlin
summary(svr_nlin)
nlin_predict = predict(svr_nlin,newdata  = test_scale)
nlin_predict
nlin_mae = mae(test_scale$cnt,nlin_predict)
nlin_mae
nlin_rmse = rmse(test_scale$cnt,nlin_predict)
nlin_rmse
